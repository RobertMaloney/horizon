var fs=require("fs"),ws=require("./lib/windows-shortcuts/lib/windows-shortcuts.js"),PanelData=function(n){this.name=n,this.links=[]};PanelData.prototype.addLink=function(n){return this.links.push({name:n.name,uri:n.uri}),!0},PanelData.prototype.removeAt=function(n){return n>=this.links.length?!1:0>n?!1:(this.links.splice(n,1),!0)},PanelData.prototype.addFileByEvent=function(n,t){n.preventDefault();var e=n.dataTransfer.files[0],i=this.addLink.bind(this);parseConfig(e.path,function(n,e){n||i(e),t(!n)})},String.prototype.capFirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var parseConfig=function(n,t){var e=!1,i=n.slice(n.lastIndexOf("\\")+1),r=fs.lstatSync(n);if(r.isDirectory())t(e,{name:i,uri:n});else{var a=i.slice(i.lastIndexOf(".")+1);i=i.slice(0,i.lastIndexOf(".")),"lnk"===a?ws.query(n,function(n,e){t(n,{name:i,uri:e.target})}):t(e,{name:i,uri:n})}};document.getElementById("main").addEventListener("mousedown",function(n){n.preventDefault()},!1),window.ondragover=function(n){return n.dataTransfer.dropEffect="none",n.preventDefault(),!1},window.ondrop=function(n){return n.preventDefault(),!1};